# mcgl-itpe-ahk

Утилита для создания макросов, с помощью которых можно перенести изображение любого размера на доски для рисования.

[Демонстрация работы](https://i.imgur.com/bFFxQDD.mp4)

## Подготовка

Для работы необходимо иметь:

- Node.JS (https://nodejs.org)
- AHK (https://www.autohotkey.com/)

Никаких интерфейсов не предусмотрено, это консольное решение.

1. Откройте консоль. Чтобы попасть в консоль под ОС Windows необходимо кликнуть по любой точке папки Shift+ПКМ и из выпадающего списка выбрать «Открыть окно команд» или «Открыть окно PowerShell здесь».
2. Проверьте работу Node.JS если вы её установили в первый раз.

   ```cmd
   node --version
   ```

   Примерный ответ

   ```
   v20.9.0
   ```

3. Установите зависимость. Это делается один раз.
   ```cmd
   npm i
   ```
4. Если вы используете отличные настройки от дефолтных, например, у вас нет палитры/у вас не Full HD разрешение или вы используете размер интерфейса отличный от «Нормальный» обязательно откройте файл **_itpe.js_** текстовым редактором и настройте скрипт под себя. Все параметры находятся в самом верху файла и подробно прокомментированы.

5. Вы готовы к запуску.

## Запуск

1. Подготовьте изображение. Из минимального - вам необходимо чтобы высота и ширина изображения были кратны 64 и формат файла PNG. Вы так же можете самостоятельно подогнать изображение под доступные цвета в любом графическом редакторе, для удобства в проекте имеется файл палитры для бесплатного графического редактора [GIMP](https://www.gimp.org/) с уже подготовленными цветами из игры. В противном случае программа попытается интерпретировать входящие цвета с помощью шума.
2. Поместите изображение в каталог со скриптом.
3. Запустите скрипт (вы можете использовать TAB для автоподстановки)

   ```cmd
   node itpe.js ваша-картинка.png
   ```

4. Если все прошло успешно (нет ответа), то в вашем каталоге должен появится подкаталог `result` с превью изображения и ahk файлами.
5. Зайдите в игру.
6. Убедитесь что окно растянуто на весь экран.
7. Откройте холст.
8. Запустите первый ahk файл. (Просто двойной клик или пкм → **run script**)
9. Убедитесь что окно игры активно. (Переведите фокус на него простым нажатием куда-нибудь в рамках окна)
10. Уберите руки от мышки.
11. Запустите скрипт клавишей запуска (по умолчанию английская **K**)
    - Если что-то пошло не так или вы хотите досрочно завершить работу вы можете использовать клавиши остановки (**O**) и паузы (**P**)
    - Если вы поставили скрипт на паузу и не желаете продолжать его работу - не забудьте закрыть ahk в трее.

## Об особенностях работы

Скрипт рисует начиная с верхнего левого угла двигаясь по столбцам. Это значит что сначала он пойдет до упора вниз, а лишь потом сместиться по горизонтали.
Соответственно, все ahk файлы пронумерованы в соответствии с этим правилом. Первая цифра - это столбец, вторая - номер строки в этом столбце.
